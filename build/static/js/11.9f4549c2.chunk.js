(this.webpackJsonpnodejsrestclient=this.webpackJsonpnodejsrestclient||[]).push([[11],{165:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return a}));var o=e(12),r=e(16),c=function(t){return{type:r.a,error:Object(o.a)({},t)}},a=function(){return{type:r.d}}},167:function(t,n,e){"use strict";e.d(n,"k",(function(){return u})),e.d(n,"f",(function(){return i})),e.d(n,"i",(function(){return f})),e.d(n,"a",(function(){return l})),e.d(n,"h",(function(){return d})),e.d(n,"b",(function(){return m})),e.d(n,"d",(function(){return h})),e.d(n,"j",(function(){return a})),e.d(n,"c",(function(){return p})),e.d(n,"g",(function(){return w})),e.d(n,"e",(function(){return s}));var o=e(16),r=e(169),c=e(165);function a(t){Object(r.b)(t)}var u=function(t){return{type:o.f,user:t}},i=function(){return{type:o.c}},f=function(t,n){return{type:o.e,code:t,expiry:n}};function s(t){return new Promise((function(n,e){window.localStorage.getItem("jwt")&&(window.localStorage.removeItem("jwt"),t(i()),n())}))}function l(t,n,e,o){return new Promise((function(i,s){return Object(r.a)("post","/api/auth/".concat(n),e).then((function(e){var r=e.token;"login"===n?(a(r),h().then((function(n){var e=n.isEmailConfirmed,a=n.twoFactorEnable;if(console.log("isEmailConfirmed",e),console.log("twoFactorEnable",a),e)if(a)d().then((function(n){var e=n.code,c=n.expiration;console.log("2faCodeSent. Yayyyy!"),t(f(e,c)),window.localStorage.setItem("jwt",r),o.push("/two-factor")})).catch((function(t){console.log("2faCodeError. Nayyyy!",t),o.push("/login")}));else{window.localStorage.setItem("jwt",r);var i=Object.assign({},n);t(u(i)),o.push("/")}else{t(Object(c.a)({message:"Please confirm your email address to access your account"}))}}))):"register"===n&&o.push("/login"),i()})).catch((function(n){t(Object(c.a)(n)),s()}))}))}function d(){return new Promise((function(t,n){return Object(r.a)("put","/api/auth/two-factor").then((function(n){var e=n.code,o=n.expiration;t({code:e,expiration:o})})).catch((function(t){n(t)}))}))}function m(t,n){return new Promise((function(e,a){return Object(r.a)("post","/api/auth/two-factor",{code:t}).then((function(){n({type:o.b}),e()})).catch((function(t){n(Object(c.a)(t)),a()}))}))}function h(){return new Promise((function(t,n){return Object(r.a)("get","/api/auth/account").then((function(n){var e=n.data;t(e)})).catch((function(t){console.log(t),n()}))}))}function p(t){return new Promise((function(n,e){return Object(r.a)("post","/api/auth/forgotpassword",t).then((function(){n()})).catch((function(t){console.log("forgotPasswordError",t),e(t)}))}))}function w(t,n){return new Promise((function(e,o){return Object(r.a)("post","/api/auth/resetpassword?token=".concat(t),n).then((function(){e()})).catch((function(t){console.log("resetPasswordError",t),o(t)}))}))}},169:function(t,n,e){"use strict";e.d(n,"b",(function(){return a}));var o=e(183),r=e.n(o),c=e(180),a=function(t){t?r.a.defaults.headers.common.Authorization="Bearer ".concat(t):delete r.a.defaults.headers.common.Authorization},u="".concat(c.a,"/");n.a=function(t,n,e){return new Promise((function(o,c){return r.a[t.toLowerCase()]("".concat(u).concat(n),e).then((function(t){return o(t.data)})).catch((function(t){return c(t.response.data.error)}))}))}},180:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var o="https://nodejsrestapi.margaiwangara.me/"},224:function(t,n,e){"use strict";e.r(n);var o=e(0),r=e.n(o),c=e(2),a=e(56),u=e(167),i=r.a.lazy((function(){return e.e(17).then(e.bind(null,200))})),f=r.a.lazy((function(){return e.e(18).then(e.bind(null,201))})),s=r.a.lazy((function(){return e.e(10).then(e.bind(null,221))})),l=r.a.lazy((function(){return e.e(5).then(e.bind(null,202))})),d=r.a.lazy((function(){return e.e(16).then(e.bind(null,222))})),m=r.a.lazy((function(){return e.e(12).then(e.bind(null,216))})),h=r.a.lazy((function(){return e.e(13).then(e.bind(null,217))}));n.default=function(){var t=Object(a.b)(),n=Object(c.g)();return Object(o.useEffect)((function(){var e=window.localStorage.getItem("jwt");e?(Object(u.j)(e),Object(u.d)().then((function(n){var e={email:n.email,name:n.name,surname:n.surname,createdAt:n.createdAt,profileImage:n.profileImage,twoFactorCode:n.twoFactorCode,twoFactorCodeExpire:n.twoFactorCodeExpire,recoveryEmail:n.recoveryEmail,twoFactorEnable:n.twoFactorEnable};t(Object(u.k)(e))})).catch((function(){return t(Object(u.f)())}))):(t(Object(u.f)()),n.push("/login"))}),[]),r.a.createElement(c.d,null,r.a.createElement(h,{exact:!0,path:"/register",name:"Register",component:f}),r.a.createElement(h,{exact:!0,path:"/login",name:"Login",component:i}),r.a.createElement(h,{exact:!0,path:"/reset-password",name:"Reset Password",component:l}),r.a.createElement(h,{exact:!0,path:"/two-factor",name:"Two Factor",component:s}),r.a.createElement(m,{path:"/",component:d}))}}}]);
//# sourceMappingURL=11.9f4549c2.chunk.js.map